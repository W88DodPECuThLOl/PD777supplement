# μPD777のパターンコンバータ

# これは何？
μPD777というののパターンコンバータです。

# ビルド方法
1. ptn777.slnを開き
2. ビルドします

# 使い方

    ptn777 入力ファイル7x7 入力ファイル8x7 出力ファイル

## 入力ファイル7x7
7x7のパターンを定義する画像ファイル。  

* 画像ファイルのサイズは横49ドット、縦98ドット。
* 7x7で１つのパターンを定義し、
* 横に7個、縦に14個のパターンが並びます。
* ドットの値は、あるか無いかの２値で、
* 黒色(RGB値0,0,0)は0、それ以外は1となります。
* 赤色(255,0,0)を使ったパターンは、ベントパターンとなり、
* 横一列のパターンのグループ（７個）が、全部ベントパターンとなります。  
  ※ベントパターンは、特有の斜めのパターンです

## 入力ファイル8x7
8x7のパターンを定義する画像ファイル。  

* 画像ファイルのサイズは横56ドット、縦14ドット。
* 8x7で１つのパターンを定義し、
* 横に7個、縦に2個のパターンが並びます。
* ドットの値は、あるか無いかの２値で、
* 黒色(RGB値0,0,0)は0、それ以外は1となります。
* ※8x7のパターンには、ベントはありません。
* X軸方向のリピートのパターン  
  ※リピートの終了位置は、パターンにより固定。

## 出力ファイル
パターンが変換されたバイナリ形式のファイルです。  
拡張子はptn777を推奨します。

### 出力ファイルの形式

ヘッダー部分 + バイナリ部分で構成されています。

#### ヘッダー部分

| Offset | Size |   | 説明 |
|---|---|---|---|
| +0x00 |  16  | MagicNumber   | マジックナンバー |
| +0x10 |  4  | FormatVersion | フォーマットのバージョン '0000' |
| +0x14 |  4  | Padding1      | 未使用。0固定 |
| +0x18 |  4  | Padding2      | 未使用。0固定 |
| +0x1C |  4  | Padding3      | 未使用。0固定 |
| +0x20 |  16 | bent[16]      | ベント |

##### マジックナンバー

16文字で\*CassetteVision\*

##### フォーマットのバージョン

4文字で0000

##### ベント

* ベントパターンを指定するものです。
* ベントパターンは、7個単位のパターンで指定されます。
* 値0xFFはエンドマーカーで、データの終了を意味します。  
  ※エンドマーカー以降は0で埋めること
* 赤色が含まれたパターンの横７個のグループが対象

例1）

    bent[0]=0x10; bent[1]=0xFF;  

0x10～0x16のパターンがベントパターンになる。  

例2）

    bent[0]=0x18; bent[1]=0x30; bent[2]=0xFF;
  
0x18～0x1Eのパターン、0x30～0x37のパターンがベントパターンになる。  

#### バイナリ部分

「7x7のパターン」「8x7のパターン」と２つのブロックからなります。

##### 7x7のパターン

* １個のパターンは7バイト
* １バイトに横7ドットのビットマップが格納されている。  
  MSB x01234567 LSB
    x: 未使用0。固定  
    0: パターンの0ドット目  
    1: パターンの1ドット目  
    2: パターンの2ドット目  
    3: パターンの3ドット目  
    4: パターンの4ドット目  
    5: パターンの5ドット目  
    6: パターンの6ドット目  

##### 8x7のパターン

* １個のパターンは7バイト
* １バイトに横8ドットのビットマップが格納されている。  
  MSB 012345678 LSB
    0: パターンの0ドット目  
    1: パターンの1ドット目  
    2: パターンの2ドット目  
    3: パターンの3ドット目  
    4: パターンの4ドット目  
    5: パターンの5ドット目  
    6: パターンの6ドット目  
    6: パターンの7ドット目  
